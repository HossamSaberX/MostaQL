{% extends "base.html" %}

{% block content %}
<div class="card">
    <h1>تنبيهات وظائف مستقل</h1>
    <p class="subtitle">اشترك للحصول على إشعارات فورية بالوظائف الجديدة</p>

    <div id="successMessage" class="alert success">
        تم إرسال رسالة التفعيل. يرجى التحقق من بريدك الإلكتروني.
    </div>

    <div id="telegramSection" style="display: none; margin-bottom: 24px;">
        <a id="telegramBtn" href="#" target="_blank" class="btn-telegram">
            <!-- Telegram Icon SVG -->
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20.665 3.717L2.335 10.786C1.084 11.286 1.089 11.984 2.103 12.295L6.81 13.764L17.704 6.893C18.22 6.58 18.693 6.753 18.307 7.096L9.482 15.053V15.052L9.481 15.054L9.156 19.916C9.633 19.916 9.843 19.699 10.11 19.44L12.43 17.187L17.257 20.753C18.147 21.244 18.787 20.991 19.009 19.93L22.18 5.004C22.505 3.48 21.691 2.789 20.665 3.717Z" fill="white"/>
            </svg>
            <span id="telegramBtnText">تفعيل تنبيهات تيليجرام فوراً</span>
        </a>
        <p class="input-hint helper-text" style="margin-top: 12px; text-align: center;">يمكنك تفعيل التنبيهات فوراً دون انتظار البريد الإلكتروني</p>
    </div>

    <div id="resetSection" style="display: none; text-align: center; margin-top: 16px;">
        <button id="resetBtn" class="primary-btn" style="background: transparent; color: var(--brand-primary); border: 1px solid var(--border-color);">
            العودة للصفحة الرئيسية
        </button>
    </div>

    <div id="errorMessage" class="alert error"></div>

    <form id="subscribeForm" novalidate>
        <div class="form-group">
            <label for="email">البريد الإلكتروني</label>
            <input
                type="email"
                id="email"
                name="email"
                placeholder="name@example.com"
                required
                dir="ltr"
                autocomplete="email"
            >
            <p id="emailError" class="input-hint error-text">البريد الإلكتروني غير صالح</p>
        </div>

        <div class="form-group">
            <label for="categories">اختر التصنيفات</label>
            <div class="categories" id="categories">
                <div class="loading">جاري تحميل التصنيفات...</div>
            </div>
            <p class="input-hint helper-text">اختر التخصصات التي تهمك للحصول على التنبيهات</p>
            <p id="categoryError" class="input-hint error-text">يجب اختيار تصنيف واحد على الأقل</p>
        </div>

        <button type="submit" class="primary-btn" id="submitBtn">
            اشترك الآن
        </button>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
    const telegramBotUsername = "{{ telegram_bot_username }}";
</script>
<script src="/assets/script.js" defer></script>
{% endblock %}

